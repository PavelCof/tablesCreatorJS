
  

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div class="category-list">
        <div class="category" draggable="true">
          <span class="category-title">Category 1</span>
          <div class="sub-category-list">
            <div class="sub-category" draggable="true">
              <span class="sub-category-title">Subcategory 1.1</span>
            </div>
            <div class="sub-category" draggable="true">
              <span class="sub-category-title">Subcategory 1.2</span>
            </div>
          </div>
        </div>
        <div class="category" draggable="true">
          <span class="category-title">Category 2</span>
          <div class="sub-category-list">
            <div class="sub-category" draggable="true">
              <span class="sub-category-title">Subcategory 2.1</span>
            </div>
            <div class="sub-category" draggable="true">
              <span class="sub-category-title">Subcategory 2.2</span>
            </div>
          </div>
        </div>
      </div>
      <script>
        const categories = document.querySelectorAll('.category');
        const subCategories = document.querySelectorAll('.sub-category');
      
        let draggedCategory = null;
        let draggedSubCategory = null;
      
        categories.forEach(category => {
          category.addEventListener('dragstart', () => {
            draggedCategory = category;
            setTimeout(() => {
              category.classList.add('dragging');
            }, 0);
          });
      
          category.addEventListener('dragend', () => {
            draggedCategory.classList.remove('dragging');
            draggedCategory = null;
          });
        });
      
        subCategories.forEach(subCategory => {
          subCategory.addEventListener('dragstart', () => {
            draggedSubCategory = subCategory;
            setTimeout(() => {
              subCategory.classList.add('dragging');
            }, 0);
          });
      
          subCategory.addEventListener('dragend', () => {
            draggedSubCategory.classList.remove('dragging');
            draggedSubCategory = null;
          });
        });
      
        const categoryLists = document.querySelectorAll('.category-list');
      
        categoryLists.forEach(categoryList => {
          categoryList.addEventListener('dragover', event => {
            event.preventDefault();
            const afterElement = getDragAfterElement(categoryList, event.clientY);
            if (afterElement == null) {
              const category = document.querySelector('.dragging');
              categoryList.appendChild(category);
            } else {
              const subCategory = draggedSubCategory;
              const parentCategory = afterElement.closest('.category');
              parentCategory.querySelector('.sub-category-list').appendChild(subCategory);
            }
          });
        });
      
        function getDragAfterElement(container, y) {
          const categoryElements = [...container.querySelectorAll('.category:not(.dragging)')];
          const subCategoryElements = [...container.querySelectorAll('.sub-category:not(.dragging)')];
          const elements = [...categoryElements, ...subCategoryElements];
          return elements.reduce((closest, child) => {
            const box = child.getBoundingClientRect();
            const offset = y - box.top - box.height / 2;
    
          if (offset < 0 && offset > closest.offset) {
            return { offset: offset, element: child };
          } else {
            return closest;
          }
        }, { offset: Number.NEGATIVE_INFINITY }).element;
      }
    </script>
</body>
</html>